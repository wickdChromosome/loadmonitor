#include <iostream>
#include <string>
#include <filesystem>

using namespace std;
namespace fs = filesystem;


/*Create a dotfile to recognize whether dir is mounted
*/
int init(string path) {

	//write a dotfile to recognize connection to dir
	path = path + "/.sshfs_monitor";	
	std::ofstream ofs(path);
	ofs << "this is some text in the new file\n"; 
	ofs.close();

	

}


int main(int argc, char* argv[]) {

	string path = argv[1];
	vector<string> files_in_dir;
	bool connection_ok = false;	

	//check if the directory is empty (if yes, the dir is unmounted)
	for (const auto & entry : fs::directory_iterator(path))

        	
		string read_in_obj = entry.path();
		if (read_in_obj[0] == ".") continue;

		cout << read_in_obj << endl;

		//if the only files we found were . and .., the folder is empty
		files_in_dir.push_back(entry.path());
		

	//if dir does not have dotfile, sshfs was unmounted
	if (file_in_dir.size() == 0) connection_ok = true;

		

	return 0;


}
